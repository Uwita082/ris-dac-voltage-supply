import board
import busio
import digitalio


spi = busio.SPI(board.SCK, MOSI=board.MOSI, MISO=board.MISO)
cs = digitalio.DigitalInOut(board.C0)
cs.direction = digitalio.Direction.OUTPUT
cs.value = True

while not spi.try_lock():
    pass

spi.configure(baudrate=25000000, phase=0, polarity=0)

commands = [
    [0x72, 0xFF, 0xFF, 0x00, 0x72, 0xFF, 0xFF, 0x00, 0x72, 0xFF, 0xFF, 0x00, 0x72, 0xFF, 0xFF, 0x00],
    [0x78, 0x80, 0x00, 0x00, 0x78, 0x80, 0x00, 0x00, 0x78, 0x80, 0x00, 0x00, 0x78, 0x80, 0x00, 0x00],
    [0x7C, 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00],
    [0x72, 0x00, 0x00, 0x00, 0x72, 0x00, 0x00, 0x00, 0x72, 0x00, 0x00, 0x00, 0x72, 0x00, 0x00, 0x00],
    [0x7B, 0x00, 0x14, 0x00, 0x7B, 0x00, 0x14, 0x00, 0x7B, 0x00, 0x14, 0x00, 0x7B, 0x00, 0x14, 0x00],
]

for command in commands:
    cs.value = False
    spi.write(bytearray(command))
    cs.value = True

command1 = bytearray([0x40, 0xFF, 0xF0, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00])
command2 = bytearray([0x40, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00])

def fast_loop():
    while True:
        cs.value = False
        spi.write(command1)
        cs.value = True
        cs.value = False
        spi.write(command2)
        cs.value = True


fast_loop()



