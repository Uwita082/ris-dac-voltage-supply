from machine import Pin, SPI

spi = SPI(0,
          baudrate=25_000_000,
          polarity=0,
          phase=0,
          bits=8,
          firstbit=SPI.MSB,
          sck=Pin(2),
          mosi=Pin(3),
          miso=Pin(4))

cs = Pin(5, Pin.OUT)
cs.value(1)

commands = [
    [0x72, 0xFF, 0xFF, 0x00, 0x72, 0xFF, 0xFF, 0x00, 0x72, 0xFF, 0xFF, 0x00, 0x72, 0xFF, 0xFF, 0x00],
    [0x78, 0x80, 0x00, 0x00, 0x78, 0x80, 0x00, 0x00, 0x78, 0x80, 0x00, 0x00, 0x78, 0x80, 0x00, 0x00],
    [0x7C, 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00, 0x7C, 0x00, 0x00, 0x00],
    [0x72, 0x00, 0x00, 0x00, 0x72, 0x00, 0x00, 0x00, 0x72, 0x00, 0x00, 0x00, 0x72, 0x00, 0x00, 0x00],
    [0x7B, 0x00, 0x14, 0x00, 0x7B, 0x00, 0x14, 0x00, 0x7B, 0x00, 0x14, 0x00, 0x7B, 0x00, 0x14, 0x00],
]

for command in commands:
    cs.value(0)
    spi.write(bytearray(command))
    cs.value(1)

command1 = bytearray([0x40, 0xFF, 0xF0, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00])
command2 = bytearray([0x40, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00])

command_minus = []
for i in range(16):
    command_minus.append(bytearray(
        [0x40 + i, 0xFF, 0xF0, 0x00, 0x40 + i, 0xFF, 0xF0, 0x00, 0x40 + i, 0xFF, 0xF0, 0x00, 0x40 + i, 0xFF, 0xF0,
         0x00]))

command_plus = []
for i in range(16):
    command_plus.append(bytearray(
        [0x40 + i, 0x00, 0x00, 0x00, 0x40 + i, 0x00, 0x00, 0x00, 0x40 + i, 0x00, 0x00, 0x00, 0x40 + i, 0x00, 0x00,
         0x00]))


def fast_loop():
    while True:
        for command in command_plus:
            cs.value(0)
            spi.write(command)
            cs.value(1)
        for command in command_minus:
            cs.value(0)
            spi.write(command)
            cs.value(1)

    # while True:
    #     cs.value(0)
    #     spi.write(command2)
    #     cs.value(1)

fast_loop()



